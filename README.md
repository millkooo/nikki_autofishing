# 无限暖暖自动钓鱼机器人 (Infinity Nikki Auto Fishing Bot)

一个专为《无限暖暖》游戏设计的自动钓鱼机器人，支持图形界面和命令行两种操作模式。

## 🎣 功能特性

- **智能状态识别**: 基于模板匹配技术，自动识别钓鱼过程中的各种状态
- **自动化操作**: 自动执行抛竿、收竿、拉扯鱼线、收线等钓鱼操作
- **连续钓鱼**: 支持设置目标钓鱼次数，实现连续自动钓鱼
- **图形界面**: 提供直观的PyQt5图形用户界面
- **透明遮罩**: 可视化显示检测区域，方便调试和监控
- **灵活配置**: 支持自定义按键、检测区域、阈值等参数

## 🛠️ 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.8+
- **游戏**: 无限暖暖 (Infinity Nikki)

## 📦 安装依赖

1. 克隆或下载项目到本地
2. 安装Python依赖包：

```bash
pip install -r requirements.txt
```

### 依赖包说明
- `numpy`: 数值计算库
- `opencv-python`: 图像处理和模板匹配
- `pillow`: 图像处理
- `pywin32`: Windows API调用
- `psutil`: 系统进程管理
- `pynput`: 键盘鼠标控制
- `PyQt5`: 图形用户界面

## 🚀 使用方法

### 图形界面模式（推荐）

```bash
python main.py
```

启动后会显示图形界面，包含以下功能：
- **启动/停止控制**: 一键启动和停止钓鱼机器人
- **目标次数设置**: 设置钓鱼目标次数（0表示无限次）
- **连续钓鱼开关**: 启用连续自动钓鱼功能
- **透明遮罩**: 显示检测区域，可调节透明度
- **实时状态显示**: 显示当前钓鱼状态和计数


## ⚙️ 配置说明

配置文件：`config.json`

### 窗口配置
```json
{
    "window": {
        "title_part": "无限暖暖",
        "window_class": "UnrealWindow", 
        "process_exe": "X6Game-Win64-Shipping.exe"
    }
}
```

### 钓鱼配置
```json
{
    "fishing": {
        "reel_key": "right_click",
        "thresholds": {
            "area_decrease": 4
        },
        "continuous": {
            "max_times": 3
        }
    }
}
```

#### 配置参数说明
- `reel_key`: 收线按键，可设置为键盘按键（如"f"、"x"）或"right_click"（鼠标右键）
- `area_decrease`: 判定面积有效减少的最小变化量
- `max_times`: 连续钓鱼的最大次数

## 🎮 使用步骤

1. **启动游戏**: 打开《无限暖暖》并进入钓鱼界面
2. **运行程序**: 执行 `python main.py` 启动
3. **调整设置**: 在图形界面中设置目标次数和连续钓鱼选项
4. **开始钓鱼**: 点击"启动"按钮开始自动钓鱼
6. **停止程序**: 点击"停止"按钮或按Ctrl+C终止程序

## 📁 项目结构

```
nikki_autofishing_2/
├── bot/                    # 机器人核心逻辑
│   ├── fishing_bot.py      # 主要机器人类
│   ├── state_handler.py    # 状态处理器
│   ├── main_loop.py        # 主循环处理
│   └── line_handler.py     # 鱼线处理器
├── Ui_Manage/              # 用户界面管理
│   ├── FishingUI.py        # 主界面
│   ├── OverlayMask.py      # 透明遮罩
│   └── WindowManager.py    # 窗口管理
├── capture/                # 屏幕捕获
├── controller/             # 输入控制
├── match/                  # 模板匹配
├── utils/                  # 工具函数
├── img/                    # 图像资源
├── config.json             # 配置文件
├── main.py                 # 程序入口
└── requirements.txt        # 依赖列表
```

## 🔧 打包为可执行文件

使用提供的构建脚本：

```bash
python build.py
```

打包完成后，可执行文件位于 `dist/auto_fishing.exe`

## ⚠️ 注意事项

1. **游戏窗口**: 确保游戏窗口标题包含"无限暖暖"
2. **分辨率**: 建议使用1920x1080分辨率以获得最佳识别效果
3. **权限**: 程序需要管理员权限来控制鼠标和键盘
4. **防病毒软件**: 某些防病毒软件可能会误报，请添加到白名单
5. **游戏更新**: 游戏更新后可能需要重新调整模板和配置

## 🐛 故障排除

### 常见问题

**Q: 程序提示"未找到游戏窗口"**
A: 确保游戏正在运行且窗口标题包含"无限暖暖"

**Q: 识别不准确或无响应**
A: 尝试调整配置文件中的阈值参数，或使用仅模板识别模式进行调试

**Q: 程序崩溃或异常退出**
A: 检查Python版本和依赖包是否正确安装，查看控制台错误信息

## 📄 许可证

本项目仅供学习和研究使用，请勿用于商业用途。使用本程序产生的任何后果由用户自行承担。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进项目！

---

**免责声明**: 本工具仅用于学习和研究目的，使用时请遵守游戏服务条款。作者不对使用本工具造成的任何后果负责。
